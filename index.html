import React, { useState } from 'react';
import { ShoppingCart, Menu, X, Plus, Minus, Sun, Moon, Sparkles, Heart, Star, Candy, Coffee, Gift, Cookie } from 'lucide-react';

const products = {
  candy: [
    { id: 'c1', name: "Rainbow Gummy Bears", description: "Chewy, fruity, and bursting with flavor! These colorful bears are your new bestie.", price: 250, rating: 4.8, image: "https://images.unsplash.com/photo-1582058091505-f87a2e55a40f?w=800&q=80" },
    { id: 'c2', name: "Sour Blast Strips", description: "For the brave! Super sour strips that'll make your face scrunch up in the best way.", price: 300, rating: 4.9, image: "https://images.unsplash.com/photo-1581798459219-c0f6b53275c7?w=800&q=80" },
    { id: 'c3', name: "Cotton Candy Cloud", description: "Fluffy, sweet, and melts in your mouth! Like eating a pink cloud of pure happiness.", price: 200, rating: 4.7, image: "https://images.unsplash.com/photo-1558961363-fa8fdf82db35?w=800&q=80" }
  ],
  chocolate: [
    { id: 'ch1', name: "Classic Chocolate Cookie", description: "Crisp edges, gooey center, packed with melty chocolate. A chocolate lover's dream!", price: 350, rating: 4.9, image: "https://images.unsplash.com/photo-1499636136210-6f4ee915583e?w=800&q=80" },
    { id: 'ch2', name: "Double Chocolate Cookie", description: "Ultra-chunky, cocoa-rich, loaded with dark chocolate. For serious choco-holics only!", price: 350, rating: 4.8, image: "https://images.unsplash.com/photo-1548365328-8c6db3220e4c?w=800&q=80" },
    { id: 'ch3', name: "Hazelnut Chocolate Cookie", description: "Decadent chocolate meets hazelnuts in a chunky cookie that's totally addictive.", price: 350, rating: 4.9, image: "https://images.unsplash.com/photo-1590080876778-b3ef04ef3cf1?w=800&q=80" }
  ],
  drinks: [
    { id: 'd1', name: "Tropical Blast Smoothie", description: "Mango, pineapple & passion fruit blended to perfection. Summer in a cup!", price: 400, rating: 4.8, image: "https://images.unsplash.com/photo-1505252585461-04db1eb84625?w=800&q=80" },
    { id: 'd2', name: "Berry Explosion Shake", description: "Strawberries, blueberries & raspberries with a creamy twist. Pure berry bliss!", price: 450, rating: 4.9, image: "https://images.unsplash.com/photo-1577805947697-89e18249d767?w=800&q=80" },
    { id: 'd3', name: "Mint Choco Chill", description: "Refreshing mint meets rich chocolate. The perfect cool-down drink!", price: 420, rating: 4.7, image: "https://images.unsplash.com/photo-1572490122747-3968b75cc699?w=800&q=80" }
  ],
  other: [
    { id: 'o1', name: "Mystery Surprise Box", description: "Can't decide? Get a curated mix of our bestsellers! Every box is a new adventure.", price: 800, rating: 5.0, image: "https://images.unsplash.com/photo-1513885535751-8b9238bd345a?w=800&q=80" },
    { id: 'o2', name: "Sweet Tooth Gift Set", description: "Perfect for your BFF! A gorgeous gift box with all the sweet essentials.", price: 1200, rating: 4.9, image: "https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=800&q=80" },
    { id: 'o3', name: "Party Pack Mega Mix", description: "Hosting a party? This mega pack has everything you need to wow your crew!", price: 1500, rating: 4.8, image: "https://images.unsplash.com/photo-1530103862676-de8c9debad1d?w=800&q=80" }
  ]
};

const categoryConfig = {
  candy: { 
    icon: Candy, 
    emoji: '🍭',
    title: 'Candy Corner',
    subtitle: 'Sweet, sour, and everything awesome!'
  },
  chocolate: { 
    icon: Cookie, 
    emoji: '🍫',
    title: 'Choco Heaven',
    subtitle: 'For all the chocolate lovers out there!'
  },
  drinks: { 
    icon: Coffee, 
    emoji: '🥤',
    title: 'Drink Zone',
    subtitle: 'Refresh, recharge, repeat!'
  },
  other: { 
    icon: Gift, 
    emoji: '🎁',
    title: 'More Goodies',
    subtitle: 'Gift sets, surprises & special treats!'
  }
};

const themes = {
  light: {
    candy: { bg: '#FFF8E7', fg: '#1C1C1C', primary: '#FF3D7F', primaryFg: '#FFFFFF', accent: '#FFB800', accentFg: '#1C1C1C', card: '#FFD6E0', border: '#FF9ACD' },
    chocolate: { bg: '#FFF4E6', fg: '#1C1C1C', primary: '#8B4513', primaryFg: '#FFFFFF', accent: '#D2691E', accentFg: '#1C1C1C', card: '#FFE6CC', border: '#D2A679' },
    drinks: { bg: '#E6F7FF', fg: '#1C1C1C', primary: '#00BFFF', primaryFg: '#FFFFFF', accent: '#66D9FF', accentFg: '#1C1C1C', card: '#CCF0FF', border: '#99E6FF' },
    other: { bg: '#F9E6FF', fg: '#1C1C1C', primary: '#FF99FF', primaryFg: '#FFFFFF', accent: '#FF66CC', accentFg: '#1C1C1C', card: '#FFD6FF', border: '#FF99CC' },
    success: '#32D74B',
    destructive: '#FF3B30'
  },
  dark: {
    candy: { bg: '#181818', fg: '#F0F0F0', primary: '#FF5C99', primaryFg: '#181818', accent: '#FFC745', accentFg: '#181818', card: '#2C1B2B', border: '#FF6FA3' },
    chocolate: { bg: '#1A1A1A', fg: '#F0F0F0', primary: '#A0522D', primaryFg: '#181818', accent: '#D27A4B', accentFg: '#181818', card: '#3C2B24', border: '#B3734D' },
    drinks: { bg: '#121212', fg: '#F0F0F0', primary: '#1E90FF', primaryFg: '#181818', accent: '#3399FF', accentFg: '#181818', card: '#0F1F33', border: '#3399FF' },
    other: { bg: '#1B0F1B', fg: '#F0F0F0', primary: '#FF66CC', primaryFg: '#181818', accent: '#FF99FF', accentFg: '#181818', card: '#2C1B2C', border: '#FF66CC' },
    success: '#3DE58D',
    destructive: '#FF4C4C'
  }
};

export default function SugarizzApp() {
  const [cart, setCart] = useState([]);
  const [darkMode, setDarkMode] = useState(false);
  const [activeCategory, setActiveCategory] = useState('candy');
  const [expandedCard, setExpandedCard] = useState(null);
  const [favorites, setFavorites] = useState([]);
  const [quantity, setQuantity] = useState({});

  const theme = themes[darkMode ? 'dark' : 'light'];
  const currentTheme = theme[activeCategory];

  const addToCart = (product, qty = 1) => {
    const existing = cart.find(item => item.id === product.id);
    if (existing) {
      setCart(cart.map(item => 
        item.id === product.id ? {...item, quantity: item.quantity + qty} : item
      ));
    } else {
      setCart([...cart, {...product, quantity: qty}]);
    }
  };

  const toggleFavorite = (id) => {
    setFavorites(prev => 
      prev.includes(id) ? prev.filter(fav => fav !== id) : [...prev, id]
    );
  };

  const updateQuantity = (id, value) => {
    setQuantity(prev => ({...prev, [id]: Math.max(1, (prev[id] || 1) + value)}));
  };

  const toggleCard = (id) => {
    setExpandedCard(expandedCard === id ? null : id);
  };

  return (
    <div style={{
      minHeight: '100vh',
      background: `linear-gradient(135deg, ${currentTheme.bg} 0%, ${currentTheme.card} 50%, ${currentTheme.bg} 100%)`,
      color: currentTheme.fg,
      transition: 'all 0.5s ease'
    }}>
      {/* Header */}
      <header style={{
        background: currentTheme.card,
        borderBottom: `3px solid ${currentTheme.border}`,
        position: 'sticky',
        top: 0,
        zIndex: 50,
        boxShadow: `0 4px 20px ${currentTheme.primary}40`
      }}>
        <div style={{
          maxWidth: '1280px',
          margin: '0 auto',
          padding: '1rem 1.5rem',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'space-between',
          flexWrap: 'wrap',
          gap: '1rem'
        }}>
          <div style={{display: 'flex', alignItems: 'center', gap: '0.75rem'}}>
            <Sparkles style={{color: currentTheme.primary, width: '32px', height: '32px'}} />
            <div style={{
              fontSize: '2rem',
              fontWeight: 'bold',
              background: `linear-gradient(135deg, ${currentTheme.primary}, ${currentTheme.accent})`,
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              backgroundClip: 'text'
            }}>
              Sugarizz
            </div>
          </div>
          
          <div style={{display: 'flex', alignItems: 'center', gap: '1rem'}}>
            <button
              onClick={() => setDarkMode(!darkMode)}
              style={{
                padding: '0.5rem',
                borderRadius: '50%',
                background: currentTheme.accent,
                border: 'none',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                transition: 'transform 0.2s',
                boxShadow: `0 4px 12px ${currentTheme.accent}60`
              }}
              onMouseEnter={(e) => e.currentTarget.style.transform = 'rotate(180deg) scale(1.1)'}
              onMouseLeave={(e) => e.currentTarget.style.transform = 'rotate(0deg) scale(1)'}
            >
              {darkMode ? <Sun color={currentTheme.accentFg} size={20} /> : <Moon color={currentTheme.accentFg} size={20} />}
            </button>
            
            <button style={{
              position: 'relative',
              padding: '0.5rem',
              background: currentTheme.primary,
              border: 'none',
              borderRadius: '50%',
              cursor: 'pointer',
              boxShadow: `0 4px 12px ${currentTheme.primary}60`,
              transition: 'transform 0.2s'
            }}
            onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.1)'}
            onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
            >
              <ShoppingCart color={currentTheme.primaryFg} size={20} />
              {cart.length > 0 && (
                <span style={{
                  position: 'absolute',
                  top: '-5px',
                  right: '-5px',
                  background: currentTheme.accent,
                  color: currentTheme.accentFg,
                  fontSize: '0.75rem',
                  fontWeight: 'bold',
                  borderRadius: '50%',
                  width: '20px',
                  height: '20px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  animation: 'bounce 0.5s'
                }}>
                  {cart.reduce((sum, item) => sum + item.quantity, 0)}
                </span>
              )}
            </button>
          </div>
        </div>
      </header>

      {/* Category Tabs */}
      <div style={{
        background: currentTheme.card,
        borderBottom: `2px solid ${currentTheme.border}`,
        position: 'sticky',
        top: '72px',
        zIndex: 40
      }}>
        <div style={{
          maxWidth: '1280px',
          margin: '0 auto',
          padding: '0.5rem 1rem',
          display: 'flex',
          gap: '0.5rem',
          overflowX: 'auto',
          WebkitOverflowScrolling: 'touch'
        }}>
          {Object.keys(products).map((cat) => {
            const Icon = categoryConfig[cat].icon;
            const isActive = activeCategory === cat;
            const catTheme = theme[cat];
            
            return (
              <button
                key={cat}
                onClick={() => {
                  setActiveCategory(cat);
                  setExpandedCard(null);
                }}
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem',
                  padding: '0.75rem 1.5rem',
                  background: isActive ? catTheme.primary : 'transparent',
                  color: isActive ? catTheme.primaryFg : currentTheme.fg,
                  border: `2px solid ${isActive ? catTheme.primary : catTheme.border}`,
                  borderRadius: '50px',
                  fontWeight: 'bold',
                  cursor: 'pointer',
                  transition: 'all 0.3s ease',
                  whiteSpace: 'nowrap',
                  boxShadow: isActive ? `0 4px 15px ${catTheme.primary}40` : 'none',
                  transform: isActive ? 'scale(1.05)' : 'scale(1)'
                }}
                onMouseEnter={(e) => {
                  if (!isActive) {
                    e.currentTarget.style.background = catTheme.card;
                    e.currentTarget.style.transform = 'scale(1.05)';
                  }
                }}
                onMouseLeave={(e) => {
                  if (!isActive) {
                    e.currentTarget.style.background = 'transparent';
                    e.currentTarget.style.transform = 'scale(1)';
                  }
                }}
              >
                <Icon size={20} />
                <span>{categoryConfig[cat].title}</span>
              </button>
            );
          })}
        </div>
      </div>

      {/* Hero Section */}
      <section style={{
        padding: '3rem 1.5rem',
        textAlign: 'center',
        position: 'relative',
        overflow: 'hidden'
      }}>
        <div style={{
          position: 'absolute',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          opacity: 0.1,
          backgroundImage: `radial-gradient(circle, ${currentTheme.primary} 1px, transparent 1px)`,
          backgroundSize: '50px 50px'
        }} />
        
        <div style={{fontSize: '4rem', marginBottom: '0.5rem'}}>
          {categoryConfig[activeCategory].emoji}
        </div>
        
        <h1 style={{
          fontSize: 'clamp(2rem, 6vw, 3.5rem)',
          fontWeight: 'bold',
          marginBottom: '0.5rem',
          position: 'relative',
          textShadow: `2px 2px 0 ${currentTheme.primary}40`
        }}>
          {categoryConfig[activeCategory].title}
        </h1>
        
        <p style={{
          fontSize: '1.25rem',
          opacity: 0.9,
          marginBottom: '2rem'
        }}>
          {categoryConfig[activeCategory].subtitle}
        </p>
      </section>

      {/* Products Grid */}
      <section style={{padding: '2rem 1.5rem', maxWidth: '1280px', margin: '0 auto'}}>
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(auto-fill, minmax(300px, 1fr))',
          gap: '2rem'
        }}>
          {products[activeCategory].map((product) => {
            const isExpanded = expandedCard === product.id;
            const isFav = favorites.includes(product.id);
            const qty = quantity[product.id] || 1;
            
            return (
              <div
                key={product.id}
                style={{
                  background: currentTheme.card,
                  borderRadius: '20px',
                  overflow: 'hidden',
                  border: `3px solid ${currentTheme.border}`,
                  cursor: 'pointer',
                  transition: 'all 0.3s ease',
                  boxShadow: `0 8px 25px ${currentTheme.border}40`,
                  transform: isExpanded ? 'scale(1.02)' : 'scale(1)',
                  position: 'relative'
                }}
                onMouseEnter={(e) => {
                  if (!isExpanded) e.currentTarget.style.transform = 'translateY(-8px)';
                }}
                onMouseLeave={(e) => {
                  if (!isExpanded) e.currentTarget.style.transform = 'translateY(0)';
                }}
              >
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    toggleFavorite(product.id);
                  }}
                  style={{
                    position: 'absolute',
                    top: '1rem',
                    right: '1rem',
                    zIndex: 10,
                    background: isFav ? theme.destructive : 'rgba(255,255,255,0.9)',
                    border: 'none',
                    borderRadius: '50%',
                    padding: '0.5rem',
                    cursor: 'pointer',
                    transition: 'all 0.2s',
                    boxShadow: '0 4px 12px rgba(0,0,0,0.2)'
                  }}
                  onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.1)'}
                  onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
                >
                  <Heart 
                    size={20} 
                    fill={isFav ? '#fff' : 'none'} 
                    color={isFav ? '#fff' : theme.destructive}
                  />
                </button>
                
                <div
                  onClick={() => toggleCard(product.id)}
                  style={{
                    height: '220px',
                    overflow: 'hidden',
                    position: 'relative',
                    background: `linear-gradient(135deg, ${currentTheme.primary}40, ${currentTheme.accent}40)`
                  }}
                >
                  <img
                    src={product.image}
                    alt={product.name}
                    style={{
                      width: '100%',
                      height: '100%',
                      objectFit: 'cover',
                      transition: 'transform 0.3s',
                      transform: isExpanded ? 'scale(1.1)' : 'scale(1)',
                      mixBlendMode: darkMode ? 'lighten' : 'multiply',
                      opacity: 0.9
                    }}
                  />
                </div>
                
                <div style={{padding: '1.5rem'}}>
                  <div style={{
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'space-between',
                    marginBottom: '0.75rem'
                  }}>
                    <div style={{display: 'flex', alignItems: 'center', gap: '0.25rem'}}>
                      <Star size={18} fill={currentTheme.accent} color={currentTheme.accent} />
                      <span style={{fontWeight: 'bold', color: currentTheme.accent, fontSize: '1.1rem'}}>
                        {product.rating}
                      </span>
                    </div>
                  </div>
                  
                  <h3 style={{
                    fontSize: '1.25rem',
                    fontWeight: 'bold',
                    marginBottom: '0.5rem',
                    color: currentTheme.fg
                  }}>
                    {product.name}
                  </h3>
                  
                  <p style={{
                    fontSize: '0.875rem',
                    opacity: 0.85,
                    marginBottom: '1rem',
                    display: isExpanded ? 'block' : '-webkit-box',
                    WebkitLineClamp: isExpanded ? 'unset' : 2,
                    WebkitBoxOrient: 'vertical',
                    overflow: 'hidden',
                    lineHeight: '1.6'
                  }}>
                    {product.description}
                  </p>
                  
                  {isExpanded && (
                    <div style={{
                      display: 'flex',
                      alignItems: 'center',
                      gap: '1rem',
                      marginBottom: '1rem',
                      padding: '0.75rem',
                      background: darkMode ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)',
                      borderRadius: '12px',
                      border: `2px solid ${currentTheme.border}`
                    }}>
                      <span style={{fontWeight: 'bold', fontSize: '1rem'}}>Qty:</span>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          updateQuantity(product.id, -1);
                        }}
                        style={{
                          background: currentTheme.border,
                          border: 'none',
                          borderRadius: '50%',
                          width: '36px',
                          height: '36px',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          cursor: 'pointer',
                          transition: 'transform 0.2s'
                        }}
                        onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.15)'}
                        onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
                      >
                        <Minus size={18} color={currentTheme.fg} />
                      </button>
                      <span style={{
                        fontSize: '1.5rem',
                        fontWeight: 'bold',
                        minWidth: '2.5rem',
                        textAlign: 'center',
                        color: currentTheme.primary
                      }}>
                        {qty}
                      </span>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          updateQuantity(product.id, 1);
                        }}
                        style={{
                          background: currentTheme.primary,
                          border: 'none',
                          borderRadius: '50%',
                          width: '36px',
                          height: '36px',
                          display: 'flex',
                          alignItems: 'center',
                          justifyContent: 'center',
                          cursor: 'pointer',
                          transition: 'transform 0.2s',
                          boxShadow: `0 4px 12px ${currentTheme.primary}60`
                        }}
                        onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.15)'}
                        onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
                      >
                        <Plus size={18} color={currentTheme.primaryFg} />
                      </button>
                    </div>
                  )}
                  
                  <div style={{
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'space-between',
                    gap: '1rem'
                  }}>
                    <span style={{
                      fontSize: '2rem',
                      fontWeight: 'bold',
                      color: currentTheme.primary
                    }}>
                      ₹{product.price}
                    </span>
                    <button
                      onClick={(e) => {
                        e.stopPropagation();
                        addToCart(product, qty);
                      }}
                      style={{
                        background: `linear-gradient(135deg, ${currentTheme.primary}, ${currentTheme.accent})`,
                        color: currentTheme.primaryFg,
                        padding: '0.75rem 1.5rem',
                        border: 'none',
                        borderRadius: '50px',
                        fontWeight: 'bold',
                        fontSize: '0.95rem',
                        cursor: 'pointer',
                        boxShadow: `0 4px 15px ${currentTheme.primary}40`,
                        transition: 'transform 0.2s',
                        whiteSpace: 'nowrap'
                      }}
                      onMouseEnter={(e) => e.currentTarget.style.transform = 'scale(1.05)'}
                      onMouseLeave={(e) => e.currentTarget.style.transform = 'scale(1)'}
                    >
                      Add to Cart
                    </button>
                  </div>
                </div>
              </div>
            );
          })}
        </div>
      </section>

      {/* Footer */}
      <footer style={{
        background: currentTheme.card,
        borderTop: `3px solid ${currentTheme.border}`,
        padding: '3rem 1.5rem',
        marginTop: '4rem'
      }}>
        <div style={{
          maxWidth: '1280px',
          margin: '0 auto',
          textAlign: 'center'
        }}>
          <div style={{
            fontSize: '2rem',
            fontWeight: 'bold',
            marginBottom: '1rem',
            background: `linear-gradient(135deg, ${currentTheme.primary}, ${currentTheme.accent})`,
            WebkitBackgroundClip: 'text',
            WebkitTextFillColor: 'transparent',
            backgroundClip: 'text'
          }}>
            Sugarizz
          </div>
          <p style={{opacity: 0.9, marginBottom: '0.5rem', fontSize: '1.1rem'}}>
            Your ultimate destination for everything sweet! 🍬✨
          </p>
          <p style={{opacity: 0.7, fontSize: '0.875rem'}}>
            © 2025 Sugarizz. All rights reserved. Made with 💖 for teens everywhere!
          </p>
        </div>
      </footer>

      <style>{`
        @keyframes bounce {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.2); }
        }
        
        * {
          scrollbar-width: thin;
          scrollbar-color: ${currentTheme.primary} ${currentTheme.card};
        }
        
        *::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        
        *::-webkit-scrollbar-track {
          background: ${currentTheme.card};
        }
        
        *::-webkit-scrollbar-thumb {
          background: ${currentTheme.primary};
          border-radius: 10px;
        }
        
        *::-webkit-scrollbar-thumb:hover {
          background: ${currentTheme.accent};
        }
      `}</style>
    </div>
  );
}
